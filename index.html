<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>JayLabs Playground</title>
    <link rel="icon" type="image/png" href="Images/Favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        /* --- FONTS --- */
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;600;700&family=Share+Tech+Mono&family=Orbitron:wght@500;900&family=Roboto+Condensed:wght@700&display=swap');

        /* --- GLOBAL VARIABLES --- */
        :root {
            font-family: "Space Grotesk", system-ui, sans-serif;
            color-scheme: dark;
            --bg-deep: #030511;
            --accent-cyan: #00d9ff;
            --accent-purple: #9d00ff;
            --accent-magenta: #ff00ea;
            --text-1: #ffffff;
            --text-2: rgba(200, 220, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
            
            /* Hi-Fi Unit Colors */
            --metal-light: #e0e0e0;
            --metal-mid: #b0b0b0;
            --metal-dark: #2a2a2a;
            --lcd-bg: #101215;
            --lcd-off: #111;
            --lcd-text: #00f0ff;
            --led-red: #ff3333;
            --led-off: #4a0000;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            min-height: 100vh;
            background-color: var(--bg-deep);
            /* Retro Grid Background */
            background-image: 
                linear-gradient(rgba(0, 217, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 217, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            color: var(--text-1);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            width: 100%;
        }

        /* --- HERO SECTION (Logo + Hi-Fi) --- */
        .hero-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 1rem 3rem;
            position: relative;
            transition: opacity 0.3s ease; /* Smooth fade when hiding */
        }

        .logo-stage {
            position: relative;
            width: 100%;
            max-width: 800px;
            aspect-ratio: 16 / 6; 
            margin-bottom: 3rem;
            filter: drop-shadow(0 0 30px rgba(0, 217, 255, 0.15));
        }

        .logo-element {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: opacity 1s ease;
        }

        .video-hidden { opacity: 0; pointer-events: none; }
        .img-hidden { opacity: 0; }
        .img-visible { opacity: 1; }

        /* --- JAYLABS JL-85 HI-FI UNIT STYLES --- */
        .hifi-unit {
            width: 1000px;
            max-width: 100%;
            height: 360px;
            background:
                repeating-linear-gradient(90deg, rgba(0, 0, 0, 0.03) 0px, rgba(0, 0, 0, 0.03) 1px, transparent 1px, transparent 4px),
                linear-gradient(to bottom, #d9d9d9 0%, #f2f2f2 10%, #bfbfbf 100%);
            border-radius: 4px;
            position: relative;
            box-shadow:
                0 0 0 1px #555,
                0 20px 50px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            display: flex;
            padding: 30px;
            gap: 20px;
            box-sizing: border-box;
            user-select: none;
            margin-bottom: 2rem;
        }

        .hifi-unit.power-off .lcd-window,
        .hifi-unit.power-off .cassette-window,
        .hifi-unit.power-off canvas {
            opacity: 0.15;
            filter: grayscale(100%);
        }

        .hifi-unit.power-off .track-info-display {
            display: none;
        }

        .hifi-unit.power-off .led-indicator {
            background-color: var(--led-off);
            box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* Screws */
        .screw {
            width: 12px;
            height: 12px;
            background: radial-gradient(circle, #eee, #888);
            border-radius: 50%;
            position: absolute;
            box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.6);
            border: 1px solid #666;
        }

        .screw::after {
            content: '+';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -55%);
            color: #555;
            font-size: 14px;
        }

        .tl {
            top: 10px;
            left: 10px;
        }

        .tr {
            top: 10px;
            right: 10px;
        }

        .bl {
            bottom: 10px;
            left: 10px;
        }

        .br {
            bottom: 10px;
            right: 10px;
        }

        /* --- SECTIONS --- */
        .section {
            display: flex;
            flex-direction: column;
            position: relative;
            height: 100%;
        }

        .left-panel {
            flex: 1.1;
            padding-right: 15px;
            border-right: 1px solid rgba(0, 0, 0, 0.1);
        }

        .center-panel {
            flex: 1.3;
            padding: 0 15px;
            border-right: 1px solid rgba(0, 0, 0, 0.1);
            border-left: 1px solid rgba(255, 255, 255, 0.5);
        }

        .right-panel {
            flex: 1;
            padding-left: 15px;
            border-left: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* Typography */
        .brand-logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 900;
            color: #222;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.5);
            margin-bottom: 2px;
        }

        .brand-logo span {
            color: #cc0000;
        }

        .label-text {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 0.55rem;
            color: #444;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-align: center;
        }

        /* --- COMPONENTS --- */

        /* Power Button */
        .power-section {
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .push-btn-square {
            width: 28px;
            height: 28px;
            background: #2a2a2a;
            border: 2px solid #555;
            border-radius: 2px;
            box-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4), inset 1px 1px 1px rgba(255, 255, 255, 0.2);
            cursor: pointer;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .push-btn-square:active {
            transform: scale(0.98);
            box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
        }

        .push-btn-square.active {
            background: #1a1a1a;
            border-color: #333;
            transform: translateY(1px);
            box-shadow: 0 0 0;
        }

        .power-led-light {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #4a0000;
            box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.8);
            border: 1px solid #000;
            transition: background 0.1s;
        }

        .push-btn-square.active .power-led-light {
            background: #ff3333;
            box-shadow: 0 0 5px #ff3333, 0 0 8px #ff0000;
            border-color: #ff5555;
        }

        /* Rectangular Function Switches (Dolby etc) */
        .rect-switch-row {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 15px;
            margin-bottom: 15px;
        }

        .rect-switch-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .rect-btn {
            width: 36px;
            height: 14px;
            background: linear-gradient(to bottom, #dcdcdc, #999);
            border: 1px solid #666;
            border-radius: 2px;
            box-shadow: 1px 2px 3px rgba(0, 0, 0, 0.3);
            cursor: pointer;
        }

        .rect-btn:active,
        .rect-btn.pressed {
            background: #777;
            box-shadow: inset 1px 1px 3px rgba(0, 0, 0, 0.6);
            transform: translateY(1px);
            border-color: #444;
        }

        /* Toggle Switches */
        .toggle-switch {
            width: 10px;
            height: 25px;
            background: linear-gradient(to right, #ccc, #fff, #ccc);
            border: 1px solid #888;
            border-radius: 2px;
            position: relative;
            cursor: pointer;
            box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.4);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 1px;
            width: 6px;
            height: 10px;
            background: #333;
            border-radius: 1px;
        }

        .toggle-switch.on::after {
            top: auto;
            bottom: 2px;
            background: #cc0000;
        }

        .speaker-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 14px;
        }

        /* Headphone Jack */
        .phone-jack-container {
            margin-top: auto;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 5px;
        }

        .phone-jack {
            width: 28px;
            height: 28px;
            background: radial-gradient(circle, #111 30%, #555 40%, #ccc 50%, #888 100%);
            border-radius: 50%;
            border: 1px solid #666;
            box-shadow: inset 1px 1px 4px rgba(0, 0, 0, 0.8), 1px 1px 2px rgba(255, 255, 255, 0.5);
            position: relative;
        }

        .phone-jack::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: #000;
            border-radius: 50%;
            box-shadow: inset 0 0 2px #000;
        }

        /* Transport Buttons (Center Panel) */
        .transport-row {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 20px;
            width: 100%;
        }

        .silver-btn {
            width: 44px;
            height: 34px;
            border-radius: 2px;
            border: 1px solid #888;
            background: linear-gradient(to bottom, #f0f0f0, #ccc);
            box-shadow: 0 3px 4px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            color: #333;
            font-family: 'Roboto Condensed', sans-serif;
        }

        .silver-btn:active {
            transform: translateY(2px);
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3);
            background: #bbb;
        }

        /* Make Eject button distinct */
        .eject-btn {
            background: linear-gradient(to bottom, #555, #333);
            color: #ccc;
            border-color: #222;
        }

        /* --- KNOBS --- */
        .knob-row {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: auto;
            padding-top: 15px;
        }

        .knob-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .knob {
            border-radius: 50%;
            background: repeating-linear-gradient(to right, #ddd 0, #ddd 1px, #bbb 1px, #bbb 2px);
            box-shadow: 2px 4px 6px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.8);
            position: relative;
            cursor: ns-resize;
            border: 1px solid #777;
            transition: transform 0.05s linear;
        }

        .knob::before {
            content: '';
            position: absolute;
            top: 5%;
            left: 5%;
            width: 90%;
            height: 90%;
            border-radius: 50%;
            background: linear-gradient(135deg, #e6e6e6 0%, #a1a1a1 100%);
            box-shadow: inset 1px 1px 2px rgba(255, 255, 255, 0.5);
        }

        .knob::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 50%;
            width: 2px;
            height: 35%;
            background: #333;
            transform: translateX(-50%);
        }

        .knob-sm {
            width: 36px;
            height: 36px;
        }

        .knob-lg {
            width: 70px;
            height: 70px;
        }

        /* --- LCD DISPLAY --- */
        .lcd-frame {
            background: #222;
            padding: 4px;
            border-radius: 4px;
            margin-top: 10px;
            margin-bottom: 10px;
            box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.8), 0 1px 0 rgba(255, 255, 255, 0.5);
        }

        .lcd-window {
            background: var(--lcd-bg);
            border: 1px solid #333;
            padding: 10px;
            position: relative;
            overflow: hidden;
            height: 110px;
            transition: opacity 0.5s;
        }

        .lcd-window::before {
            content: " ";
            position: absolute;
            inset: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
        }

        .track-info-display {
            font-family: 'Share Tech Mono', monospace;
            color: var(--lcd-text);
            text-shadow: 0 0 5px rgba(0, 240, 255, 0.5);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* --- CASSETTE DECK --- */
        .cassette-deck {
            width: 100%;
            height: 140px;
            background: #2a2a2a;
            border-radius: 2px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 1);
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }

        .cassette-window {
            width: 90%;
            height: 85%;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #444;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            transition: opacity 0.5s;
        }

        .cassette-body {
            width: 95%;
            height: 90%;
            background: #c0c0c0;
            border-radius: 4px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .tape-sticker {
            width: 90%;
            height: 70%;
            background: #eee;
            border: 1px solid #999;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            position: relative;
        }

        .tape-window-cutout {
            width: 130px;
            height: 45px;
            background: #222;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
        }

        .reel {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #fff;
            position: relative;
            border: 3px dashed #555;
        }

        .reel.spinning {
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }

        /* --- SPECTRUM & METER --- */
        .analyzer-wrapper {
            width: 100%;
            height: 80px;
            background: #151515;
            position: relative;
            border: 1px solid #444;
            display: flex;
            align-items: flex-end;
        }

        canvas {
            width: 100%;
            height: 100%;
        }

        .peak-meter-row {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
        }

        .peak-bg {
            flex: 1;
            height: 8px;
            background: #111;
            position: relative;
        }

        .peak-val {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, lime, yellow, red);
            transition: width 0.1s;
        }

        .led-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            border: 1px solid #333;
            box-shadow: inset 1px 1px 1px rgba(0, 0, 0, 0.5);
            margin-bottom: 4px;
            transition: background 0.2s;
        }

        .led-lit {
            background: var(--led-red);
            box-shadow: 0 0 5px #ff3333;
            border-color: #f00;
        }

        /* --- NAVIGATION GRID --- */
        .nav-section { padding-bottom: 4rem; flex: 1; }
        
        .lab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .card {
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
            border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.5rem;
            text-decoration: none; color: inherit; transition: transform 0.2s, background 0.2s, border-color 0.2s;
            position: relative; overflow: hidden; display: flex; flex-direction: column; min-height: 240px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .card:hover {
            transform: translateY(-5px); background: rgba(255, 255, 255, 0.04);
            border-color: var(--accent-cyan); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .pill {
            font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em;
            padding: 0.25rem 0.75rem; border-radius: 100px; background: rgba(255,255,255,0.05);
            width: fit-content; margin-bottom: 0.75rem; border: 1px solid rgba(255,255,255,0.1);
        }

        .card h2 { margin: 0 0 0.5rem; font-size: 1.4rem; color: #fff; }
        .card p { font-size: 0.95rem; color: var(--text-2); margin: 0; line-height: 1.5; flex-grow: 1; }
        
        .card-link-text {
            margin-top: 1.5rem; color: var(--accent-cyan); font-weight: 600; font-size: 0.9rem;
            display: flex; align-items: center; gap: 0.5rem; white-space: nowrap;
        }

        /* Specific Card Accents */
        .card.games:hover { border-color: var(--accent-magenta); }
        .card.games .card-link-text { color: var(--accent-magenta); }
        .card.pcvr:hover { border-color: var(--accent-cyan); }
        .card.gens:hover { border-color: var(--accent-purple); }
        .card.gens .card-link-text { color: var(--accent-purple); }

        /* Desktop Layout: Source card spans bottom */
        @media (min-width: 960px) {
            .lab-grid { grid-template-columns: repeat(3, 1fr); }
            .card.source {
                grid-column: 1 / -1; width: 70%; margin: 1rem auto 0;
                min-height: auto; flex-direction: row; align-items: center; gap: 2rem; padding: 1.2rem 2rem;
            }
            .card.source .card-content-wrapper { flex-grow: 1; display: flex; flex-direction: row; align-items: center; gap: 1.5rem; text-align: left; }
            .card.source .pill { margin-bottom: 0; }
            .card.source h2 { margin: 0; font-size: 1.2rem; min-width: 140px; }
            .card.source p { margin: 0; font-size: 0.9rem; }
            .card.source .card-link-text { margin-top: 0; }
        }

        /* --- FOOTER --- */
        footer {
            border-top: 1px solid rgba(255,255,255,0.1); padding: 2rem 1rem;
            text-align: center; color: var(--text-2); font-size: 0.85rem;
            background: rgba(0,0,0,0.3); margin-top: auto;
        }
        .footer-links { display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap; }
        footer a { color: var(--accent-cyan); text-decoration: none; transition: color 0.2s; }
        footer a:hover { color: #fff; text-decoration: underline; }
        
        @media (max-width: 600px) {
            .logo-stage { aspect-ratio: 16/9; }
            .footer-links { gap: 0.5rem; flex-direction: column; }
            .card.source { flex-direction: column; align-items: flex-start; }
            .card.source .card-content-wrapper { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
        }
    </style>
</head>
<body>

    <!-- HERO SECTION: Logo & Hi-Fi Unit -->
    <section class="hero-section">
        
        <!-- Video Transition -->
        <div class="logo-stage">
            <video 
                id="logoVideo" 
                class="logo-element" 
                src="Images/Jaylabs.mp4" 
                muted playsinline autoplay
            ></video>
            <img 
                id="logoImage" 
                src="Images/Jaylabs.svg" 
                alt="JayLabs" 
                class="logo-element img-hidden"
            >
        </div>

        <!-- JAYLABS JL-85 HI-FI UNIT -->
        <div class="hifi-unit power-off" id="hifiUnit">
            <!-- Screws -->
            <div class="screw tl"></div>
            <div class="screw tr"></div>
            <div class="screw bl"></div>
            <div class="screw br"></div>

            <!-- === LEFT PANEL: Power, LCD, Phones === -->
            <div class="section left-panel">

                <!-- Power & Branding -->
                <div class="power-section">
                    <div style="display:flex; flex-direction:column; align-items:center;">
                        <div class="label-text" style="margin-bottom:4px;">POWER</div>
                        <div class="push-btn-square" id="btnPower">
                            <div class="power-led-light"></div>
                        </div>
                    </div>
                    <div>
                        <div class="brand-logo">JAYLABS <span>AUDIO</span></div>
                        <div class="model-no" style="font-size:0.6rem; color:#555; font-weight:bold;">COMPACT SYSTEM JL-85
                        </div>
                    </div>
                </div>

                <!-- LCD Info -->
                <div class="lcd-frame">
                    <div class="lcd-window">
                        <div class="track-info-display">
                            <div
                                style="border-bottom: 1px solid #003333; padding-bottom:2px; display:flex; justify-content:space-between;">
                                <span id="trackIdx">TRK 01</span>
                                <span id="timeDisplay">00:00</span>
                            </div>
                            <div style="margin-top:5px;">
                                <div style="font-size:1.1rem; color:#fff;" id="trackTitle">INSERT DISC</div>
                                <div style="font-size:0.8rem; color:cyan;" id="trackArtist">JayLabs Audio</div>
                            </div>
                            <div style="margin-top:auto; display:flex; gap:10px;">
                                <span id="status-text" style="color:#005555">STANDBY</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Phones (Left Bottom) -->
                <div class="phone-jack-container">
                    <div class="phone-jack"></div>
                    <div class="label-text" style="text-align:left;">PHONES</div>
                </div>
            </div>

            <!-- === CENTER PANEL: Cassette & Transport === -->
            <div class="section center-panel">
                <span class="label-text" style="font-size:0.7rem; margin-bottom:5px;">STEREO CASSETTE DECK</span>

                <div class="cassette-deck">
                    <div class="cassette-window">
                        <div class="cassette-body">
                            <div class="tape-sticker">
                                <div
                                    style="width:100%; border-bottom:2px solid #c00; font-size:0.5rem; font-weight:bold; margin-bottom:5px;">
                                    JAYLABS C-90</div>
                                <div class="tape-window-cutout">
                                    <div class="reel left"></div>
                                    <div class="reel right"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Transport Controls (Now under deck) -->
                <div class="transport-row">
                    <button class="silver-btn" id="btnPrev">|&lt;</button>
                    <button class="silver-btn" id="btnPlay">PLAY</button>
                    <button class="silver-btn" id="btnStop">STOP</button>
                    <button class="silver-btn" id="btnNext">&gt;|</button>
                    <button class="silver-btn eject-btn" style="margin-left:10px;">EJECT</button>
                </div>

                <!-- Speaker Selectors -->
                <div class="speaker-row">
                    <div class="rect-switch-group">
                        <div class="label-text">SPEAKERS A</div>
                        <div class="toggle-switch on"></div>
                    </div>
                    <div class="rect-switch-group">
                        <div class="label-text">SPEAKERS B</div>
                        <div class="toggle-switch"></div>
                    </div>
                </div>
            </div>

            <!-- === RIGHT PANEL: Spectrum, Switches, Knobs === -->
            <div class="section right-panel">

                <!-- Spectrum & Meters -->
                <div>
                    <div style="display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:2px;">
                        <span class="label-text">SPECTRUM ANALYZER</span>
                        <span class="label-text">R-CH</span>
                    </div>
                    <div class="analyzer-wrapper">
                        <canvas id="spectrumCanvas"></canvas>
                    </div>
                    <div class="peak-meter-row">
                        <span class="label-text">L</span>
                        <div class="peak-bg">
                            <div class="peak-val" id="peakL"></div>
                        </div>
                    </div>
                    <div class="peak-meter-row">
                        <span class="label-text">R</span>
                        <div class="peak-bg">
                            <div class="peak-val" id="peakR"></div>
                        </div>
                    </div>
                </div>

                <!-- Function Switches (Moved here) -->
                <div class="rect-switch-row">
                    <div class="rect-switch-group">
                        <div class="led-indicator" id="led-dolby"></div>
                        <div class="rect-btn" onclick="toggleLed('led-dolby', this)"></div>
                        <span class="label-text">DOLBY NR</span>
                    </div>
                    <div class="rect-switch-group">
                        <div class="led-indicator" id="led-cro2"></div>
                        <div class="rect-btn" onclick="toggleLed('led-cro2', this)"></div>
                        <span class="label-text">CrO2</span>
                    </div>
                    <div class="rect-switch-group">
                        <div class="led-indicator" style="opacity:0;"></div>
                        <div class="rect-btn" title="Reset Counter"></div>
                        <span class="label-text">RESET</span>
                    </div>
                </div>

                <!-- Knobs Area (Bottom) -->
                <div style="display:flex; gap:10px; align-items:flex-end; margin-top:auto;">
                    <div class="knob-group">
                        <div class="knob knob-sm" id="knob-bass" data-val="50"></div>
                        <span class="label-text">BASS</span>
                    </div>
                    <div class="knob-group">
                        <div class="knob knob-sm" id="knob-treble" data-val="50"></div>
                        <span class="label-text">TREBLE</span>
                    </div>
                    <div class="knob-group">
                        <div class="knob knob-sm" id="knob-bal" data-val="50"></div>
                        <span class="label-text">BAL</span>
                    </div>

                    <div class="knob-group" style="margin-left:auto;">
                        <div class="knob knob-lg" id="knob-vol" data-val="40"></div>
                        <span class="label-text">VOLUME</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- END HI-FI UNIT -->

    </section>

    <!-- CONTENT: The Main Grid (ID required for turbo script) -->
    <div class="container nav-section" id="main-content">
        <div class="lab-grid">
            
            <a href="games.html" class="card games">
                <div class="pill">Arcade</div>
                <h2>Games</h2>
                <p>Aetherium League, Astral Core, and Defendorks. Action-packed cabinet smashers.</p>
                <div class="card-link-text">Launch Arcade &rarr;</div>
            </a>

            <a href="pcvr.html" class="card pcvr">
                <div class="pill">WebXR / VR</div>
                <h2>PCVR Lab</h2>
                <p>Experimental VR builds. Play directly in PCVR or via the Quest browser.</p>
                <div class="card-link-text">Enter VR Lab &rarr;</div>
            </a>

            <a href="generators.html" class="card gens">
                <div class="pill">Visuals</div>
                <h2>Generators</h2>
                <p>Harmonograph Studio & Spirograph Deluxe. Interactive math art tools.</p>
                <div class="card-link-text">Open Tools &rarr;</div>
            </a>

            <!-- Wide Source Card -->
            <a href="https://github.com/Jaytecit/Jaylabs" target="_blank" class="card source">
                <div class="card-content-wrapper">
                    <div class="pill">Collab</div>
                    <h2>Source Code</h2>
                    <p>View the repo, fork the projects, or contribute to the experiments.</p>
                </div>
                <div class="card-link-text">View GitHub &rarr;</div>
            </a>

        </div>
    </div>

    <footer>
        <div class="footer-links">
            <span>&copy; <span id="year"></span> JayLabs</span>
            <span>&nbsp;|&nbsp;</span>
            <a href="https://github.com/Jaytecit/Jaylabs" target="_blank" rel="noopener">GitHub</a>
            <span>&nbsp;|&nbsp;</span>
            <a href="mailto:Jay.Martooni@Jaylabs.co.uk">Contact Us</a>
            <span>&nbsp;|&nbsp;</span>
            <a href="legal.html">Legal</a>
        </div>
    </footer>

    <!-- SCRIPTS -->
    <script>
        // --- 1. Logo Video Transition ---
        const video = document.getElementById('logoVideo');
        const image = document.getElementById('logoImage');

        if(video) {
            video.addEventListener('ended', () => {
                video.classList.add('video-hidden');
                image.classList.remove('img-hidden');
                image.classList.add('img-visible');
            });
            video.addEventListener('error', () => {
                image.classList.remove('img-hidden');
                image.classList.add('img-visible');
            });
        }

        // --- 2. JAYLABS JL-85 AUDIO FIRMWARE ---
        const playlist = [
            { title: "SynthWave A", artist: "Jay Martooni", src: "Ambient.mp3" },
            { title: "Retro Future", artist: "Jay Martooni", src: "Electronic.mp3" },
             { title: "Prerequisite", artist: "Jay Martooni", src: "Oxygen.mp3" },
        ];

        let isPowerOn = false;
        let isPlaying = false;
        let currentIndex = 0;
        let audioCtx, analyser, source, dataArray, canvasCtx;
        const audio = new Audio();
        audio.crossOrigin = "anonymous";
        audio.volume = 0.4;
        audio.loop = true; // keep current track repeating until user changes it

        // DOM Elements
        const unit = document.getElementById('hifiUnit');
        const btnPower = document.getElementById('btnPower');
        const elTitle = document.getElementById('trackTitle');
        const elArtist = document.getElementById('trackArtist');
        const elTime = document.getElementById('timeDisplay');
        const elStatus = document.getElementById('status-text');
        const canvas = document.getElementById('spectrumCanvas');
        const peakL = document.getElementById('peakL');
        const peakR = document.getElementById('peakR');
        const reels = document.querySelectorAll('.reel');

        // --- POWER LOGIC ---
        btnPower?.addEventListener('click', () => {
            isPowerOn = !isPowerOn;
            btnPower.classList.toggle('active');

            if (isPowerOn) {
                unit?.classList.remove('power-off');
                loadTrack(currentIndex);
            } else {
                unit?.classList.add('power-off');
                audio.pause();
                isPlaying = false;
                setVisualState(false);
                document.querySelectorAll('.led-indicator').forEach(el => el.classList.remove('led-lit'));
                document.querySelectorAll('.rect-btn').forEach(el => el.classList.remove('pressed'));
            }
        });

        function toggleLed(ledId, btn) {
            if (!isPowerOn) return;
            const led = document.getElementById(ledId);
            led?.classList.toggle('led-lit');
            btn?.classList.toggle('pressed');
        }

        // --- AUDIO LOGIC ---
        function initContext() {
            if (!audioCtx) {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                audioCtx = new AudioContext();
                analyser = audioCtx.createAnalyser();
                try {
                    source = audioCtx.createMediaElementSource(audio);
                    source.connect(analyser);
                    analyser.connect(audioCtx.destination);
                } catch (e) { console.warn("CORS/Server needed for visualizer"); }

                analyser.fftSize = 64;
                dataArray = new Uint8Array(analyser.frequencyBinCount);
                canvasCtx = canvas?.getContext('2d');
                draw();
            }
            if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
        }

        function loadTrack(i) {
            if (!isPowerOn) return;
            if (i < 0) i = playlist.length - 1;
            if (i >= playlist.length) i = 0;
            currentIndex = i;

            audio.src = playlist[currentIndex].src;
            elTitle.textContent = playlist[currentIndex].title;
            elArtist.textContent = playlist[currentIndex].artist;
            document.getElementById('trackIdx').textContent = `TRK 0${i + 1}`;
            elStatus.textContent = "STOPPED";
            elStatus.style.color = "#005555";
        }

        function playAudio() {
            if (!isPowerOn) return;
            initContext();
            audio.play().then(() => {
                isPlaying = true;
                setVisualState(true);
                elStatus.textContent = "PLAYING >>";
                elStatus.style.color = "#fff";
            }).catch(() => {
                elTitle.textContent = "NO DISC/FILE";
            });
        }

        function stopAudio() {
            audio.pause();
            audio.currentTime = 0;
            isPlaying = false;
            setVisualState(false);
            elStatus.textContent = "STOPPED";
            elStatus.style.color = "#005555";
        }

        function setVisualState(active) {
            if (active) reels.forEach(r => r.classList.add('spinning'));
            else reels.forEach(r => r.classList.remove('spinning'));
        }

        // --- EVENTS ---
        document.getElementById('btnPlay')?.addEventListener('click', () => { if (!isPlaying) playAudio(); });
        document.getElementById('btnStop')?.addEventListener('click', stopAudio);
        document.getElementById('btnNext')?.addEventListener('click', () => { loadTrack(currentIndex + 1); playAudio(); });
        document.getElementById('btnPrev')?.addEventListener('click', () => { loadTrack(currentIndex - 1); playAudio(); });

        audio.addEventListener('timeupdate', () => {
            const m = Math.floor(audio.currentTime / 60);
            const s = Math.floor(audio.currentTime % 60);
            elTime.textContent = `${m}:${s.toString().padStart(2, '0')}`;
        });

        audio.addEventListener('ended', () => {
            if (!isPowerOn) return;
            audio.currentTime = 0;
            audio.play();
        });

        // --- SPECTRUM DRAW ---
        function draw() {
            requestAnimationFrame(draw);
            if (!isPowerOn || !canvas) return;

            const w = canvas.width = canvas.offsetWidth;
            const h = canvas.height = canvas.offsetHeight;
            canvasCtx?.clearRect(0, 0, w, h);

            if (analyser) {
                analyser.getByteFrequencyData(dataArray);
                const barW = (w / dataArray.length) * 2.5;
                let x = 0; let sum = 0;

                for (let i = 0; i < dataArray.length; i++) {
                    const barH = (dataArray[i] / 255) * h;
                    canvasCtx.fillStyle = `rgba(0, 240, 255, 0.6)`;
                    canvasCtx.fillRect(x, h - barH, barW - 1, barH);
                    x += barW;
                    sum += dataArray[i];
                }

                const avg = sum / dataArray.length;
                const pct = Math.min(100, (avg / 255) * 300);
                peakL.style.width = `${pct}%`;
                peakR.style.width = `${pct * 0.9}%`;
            }
        }

        // --- KNOB INTERACTION ---
        function setupKnob(id, isVol) {
            const knob = document.getElementById(id);
            if (!knob) return;
            let startY = 0;
            let startVal = 0;

            knob.addEventListener('mousedown', (e) => {
                startY = e.clientY;
                startVal = parseInt(knob.getAttribute('data-val'));
                document.addEventListener('mousemove', onMove);
                document.addEventListener('mouseup', onUp);
            });

            const onMove = (e) => {
                const delta = startY - e.clientY;
                let newVal = startVal + delta;
                if (newVal < 0) newVal = 0;
                if (newVal > 100) newVal = 100;

                const deg = (newVal / 100 * 270) - 135;
                knob.style.transform = `rotate(${deg}deg)`;
                knob.setAttribute('data-val', newVal.toString());

                if (isVol) {
                    audio.volume = newVal / 100;
                }
            };

            const onUp = () => {
                document.removeEventListener('mousemove', onMove);
                document.removeEventListener('mouseup', onUp);
            };

            const initDeg = (parseInt(knob.getAttribute('data-val')) / 100 * 270) - 135;
            knob.style.transform = `rotate(${initDeg}deg)`;
        }

        setupKnob('knob-vol', true);
        setupKnob('knob-bass', false);
        setupKnob('knob-treble', false);
        setupKnob('knob-bal', false);

        document.getElementById('year').textContent = new Date().getFullYear();


        // --- 3. JAYLABS TURBO LOADER (Continuous Audio Nav) ---
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.getElementById('main-content');
            const heroSection = document.querySelector('.hero-section');
            
            // Snapshot the "Home" state
            const homeHTML = mainContent.innerHTML;
            const homeClasses = mainContent.className || "container nav-section";

            document.addEventListener('click', async (e) => {
                const link = e.target.closest('a');
                if (!link) return;

                const href = link.getAttribute('href');

                // Intercept internal .html links
                if (href && href.endsWith('.html') && !href.startsWith('http') && !href.startsWith('#') && link.target !== '_blank') {
                    e.preventDefault();

                    // === BACK TO HOME ===
                    if (href.includes('index.html')) {
                        if (heroSection) heroSection.style.display = 'flex';
                        mainContent.innerHTML = homeHTML;
                        mainContent.className = homeClasses;
                        window.history.pushState({page: 'home'}, '', 'index.html');
                        return;
                    }

                    // === LOAD SUB-PAGE ===
                    try {
                        const response = await fetch(href);
                        if (!response.ok) throw new Error('Page not found');
                        const html = await response.text();

                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        const newContent = doc.querySelector('main');

                        if (newContent) {
                            if (heroSection) heroSection.style.display = 'none';
                            mainContent.innerHTML = newContent.innerHTML;
                            mainContent.className = newContent.className;
                            window.history.pushState({page: href}, '', href);
                            window.scrollTo(0, 0);
                        }
                    } catch (err) {
                        console.error("Nav Error:", err);
                        window.location.href = href; // Fallback
                    }
                }
            });

            // Browser Back Button
            window.addEventListener('popstate', (event) => {
                window.location.reload(); 
            });
        });
    </script>
</body>
</html>
